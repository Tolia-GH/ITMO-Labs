## [MainPage](../../../index.md)/[DataBase](../../README.md)/Lab 1

<center>
<p>Университет ИТМО</p>
<p>Факультет ФПИ и КТ</p>
<br><br><br><br><br>
<h2>Отчёт по лабораторной работе 1</h2>
<h1>«Информационная система и база данных»</h1>
<h3>Вариант: 310930</h3>
</center>

<br><br><br><br><br><br><br><br><br><br><br><br>

<div align="right">Студент: Чжоу Хунсян</div>
<div align="right">Группа: P33131</div>
<div align="right">Преподаватель:</div>

- [1 Текст задания.](#1-текст-задания)
- [2 Описание предметной области.](#2-описание-предметной-области)
- [3 Список сущностей и их классификацию](#3-список-сущностей-и-их-классификацию)
- [4 Инфологическая модель](#4-инфологическая-модель)
- [5 Даталогическая модель](#5-даталогическая-модель)
  - [DataBase Data](#database-data)
- [6 Реализация даталогической модели на SQL](#6-реализация-даталогической-модели-на-sql)
  - [Создание таблиц](#создание-таблиц)
  - [Data Insert in SQL](#data-insert-in-sql)
- [7 Вывод по работе](#7-вывод-по-работе)

# 1 Текст задания.

## Внимание! У разных вариантов разный текст задания!

## Цель работы

на выделенном узле создать и сконфигурировать новый кластер БД Postgres, саму БД, табличные пространства и новую роль, а также произвести наполнение базы в соответствии с заданием. Отчёт по работе должен содержать все команды по настройке, скрипты, а также измененные строки конфигурационных файлов.

Способ подключения к узлу из сети Интернет через helios:
ssh -J s336184@helios.cs.ifmo.ru:2222 postgres2@pg117
Способ подключения к узлу из сети факультета:
ssh postgres2@pg117
Номер выделенного узла pg117, а также логин и пароль для подключения Вам выдаст преподаватель.

> pg117:postgres2:FrMa3dca

## Этап 1. Инициализация кластера БД
Директория кластера: `$HOME/ewe49`
Кодировка: KOI8-R
Локаль: русская
Параметры инициализации задать через переменные окружения

```
[postgres2@pg117 ~]$ export PGDATA=$HOME/ewe49
[postgres2@pg117 ~]$ export LANG=ru_RU.KOI8-R
```

```
[postgres2@pg117 ~]$ echo $PGDATA
/var/db/postgres2/ewe49
[postgres2@pg117 ~]$ echo $LANG
ru_RU.KOI8-R
```

```
[postgres2@pg117 ~]$ initdb -D $PGDATA --locale=$LANG
?????, ??????????? ? ???? ????, ????? ???????????? ???????????? "postgres2".
?? ??? ????? ????? ????? ??????????? ??????? ???????.

??????? ??? ?????? ????? ??????????????? ? ??????? "ru_RU.KOI8-R".
????????? ?? ?? ?????????, ????????? ? ???????????? ? ???????????: "KOI8R".
??????? ???????????? ?????????? ?????? ?? ????????? "russian".

???????? ??????????? ??????? ?????? ?????ޣ?.

???????? ???????? /var/db/postgres2/ewe49... ??
???????? ????????????... ??
?????????? ?????????? ???????????? ??????????? ??????... posix
?????????? ???????? max_connections ?? ?????????... 100
?????????? ???????? shared_buffers ?? ?????????... 128MB
?????????? ??????? ???? ?? ?????????... W-SU
???????? ???????????????? ??????... ??
??????????? ???????????????? ??????... ??
??????????? ?????????????? ?????????????... ??
?????????? ?????? ?? ?????... ??

initdb: ??????????????: ????????? ?????? ?????????????? "trust" ??? ????????? ???????????
?????? ????? ????? ???????, ?????????????? pg_hba.conf ??? ????????? ????? -A,
--auth-local ??? --auth-host ??? ????????? ?????????? initdb.

??????. ?????? ?? ?????? ????????? ?????? ??? ??????:
    pg_ctl -D /var/db/postgres2/ewe49 -l ????_??????? start
```

## Этап 2. Конфигурация и запуск сервера БД
- Способы подключения: 
  1) Unix-domain сокет в режиме peer; 
  2) сокет TCP/IP, принимать подключения к любому IP-адресу узла
- Номер порта: 9806
- Способ аутентификации TCP/IP клиентов: по имени пользователя
  - Остальные способы подключений запретить.
  - Настроить следующие параметры сервера БД:
  - max_connections
  - shared_buffers
  - temp_buffers
  - work_mem
  - checkpoint_timeout
  - effective_cache_size
  - fsync
  - commit_delay
  Параметры должны быть подобраны в соответствии с аппаратной конфигурацией:
  оперативная память 12ГБ, хранение на жёстком диске (HDD).
- Директория WAL файлов: $HOME/svq55
- Формат лог-файлов: .csv
- Уровень сообщений лога: ERROR
- Дополнительно логировать: завершение сессий и продолжительность выполнения команд

## Этап 3. Дополнительные табличные пространства и наполнение базы
- Создать новые табличные пространства для партицированной таблицы: $HOME/gje71, $HOME/xca33
- На основе template1 создать новую базу: fatbluefish
- Создать новую роль, предоставить необходимые права, разрешить подключение к базе.
- От имени новой роли (не администратора) произвести наполнение ВСЕХ созданных баз тестовыми наборами данных. ВСЕ табличные пространства должны использоваться по назначению.
- Вывести список всех табличных пространств кластера и содержащиеся в них объекты.

## Вопросы для подготовки к защите
- Способы запуска и остановки сервера PosgreSQL, их отличия.
- Какие параметры локали сервера БД можно настроить? На что они влияют? Как и где их переопределить?
- Конфигурационные файлы сервера. Способы изменения и применения конфигурации.
- Что такое табличное пространство? Зачем нужны дополнительные табличные пространства?
- Зачем нужны template0 и template1?

