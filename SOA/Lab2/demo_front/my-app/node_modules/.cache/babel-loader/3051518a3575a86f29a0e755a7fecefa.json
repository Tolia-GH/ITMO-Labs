{"ast":null,"code":"var _jsxFileName = \"/Users/2398768715qq.com/GitHub/ITMO-Labs/SOA/Lab2/demo_front/my-app/src/components/main/main.jsx\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport '../../assets/css/page_style.css';\nimport { Table, Form, Button, Pagination, Alert } from 'react-bootstrap';\nimport XMLParser from 'xml-js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Main extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.fetchMarines = async () => {\n      try {\n        const params = new URLSearchParams({\n          page: this.state.currentPage,\n          pageSize: this.state.pageSize,\n          sort: this.state.sortField,\n          order: this.state.sortOrder,\n          filter: this.state.filters\n        });\n        const response = await axios.get(`https://localhost:8083/api/v1/space-marine?${params}`);\n        const result = XMLParser.xml2js(response.data, {\n          compact: true\n        });\n        this.setState({\n          marines: result.SpaceMarines.SpaceMarine,\n          totalPages: Math.ceil(result.totalCount._text / this.state.pageSize)\n        });\n      } catch (error) {\n        this.handleError(error);\n      }\n    };\n\n    this.handleSort = field => {\n      this.setState(prev => ({\n        sortField: field,\n        sortOrder: prev.sortField === field ? prev.sortOrder === 'ASC' ? 'DESC' : 'ASC' : 'ASC'\n      }), this.fetchMarines);\n    };\n\n    this.handleFilter = e => {\n      const filter = `${e.target.name}${e.target.value}`;\n      this.setState(prev => ({\n        filters: [...prev.filters, filter]\n      }), this.fetchMarines);\n    };\n\n    this.handlePageChange = page => {\n      this.setState({\n        currentPage: page\n      }, this.fetchMarines);\n    };\n\n    this.handleCreate = async e => {\n      e.preventDefault();\n\n      try {\n        const xmlBody = this.buildMarineXML(this.state.newMarine);\n        await axios.post('https://localhost:8083/api/v1/space-marine', xmlBody, {\n          headers: {\n            'Content-Type': 'application/xml'\n          }\n        });\n        this.fetchMarines();\n        this.setState({\n          showCreateForm: false\n        });\n      } catch (error) {\n        this.handleError(error);\n      }\n    };\n\n    this.buildMarineXML = marine => {\n      return `\n      <NewSpaceMarine>\n        <name>${marine.name}</name>\n        <coordinates>\n          <x>${marine.coordinates.x}</x>\n          <y>${marine.coordinates.y}</y>\n        </coordinates>\n        <health>${marine.health}</health>\n        <heartCount>${marine.heartCount}</heartCount>\n        <height>${marine.height}</height>\n        <meleeWeapon>${marine.meleeWeapon}</meleeWeapon>\n        <chapter>\n          <name>${marine.chapter.name}</name>\n        </chapter>\n      </NewSpaceMarine>\n    `;\n    };\n\n    this.handleError = error => {\n      const errorData = XMLParser.xml2js(error.response.data, {\n        compact: true\n      });\n      this.setState({\n        error: errorData.error.message._text || 'Unknown error occurred'\n      });\n      setTimeout(() => this.setState({\n        error: null\n      }), 5000);\n    };\n\n    this.state = {\n      marines: [],\n      currentPage: 0,\n      pageSize: 10,\n      totalPages: 0,\n      sortField: 'id',\n      sortOrder: 'ASC',\n      filters: [],\n      error: null,\n      showCreateForm: false,\n      newMarine: {\n        name: '',\n        coordinates: {\n          x: 0,\n          y: 0\n        },\n        health: 100,\n        heartCount: 1,\n        height: 1.8,\n        meleeWeapon: 'CHAIN_SWORD',\n        chapter: {\n          name: ''\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.fetchMarines();\n  }\n\n  renderTable() {\n    return /*#__PURE__*/_jsxDEV(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      responsive: true,\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            onClick: () => this.handleSort('id'),\n            children: \"ID\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            onClick: () => this.handleSort('name'),\n            children: \"Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Coordinates\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            onClick: () => this.handleSort('health'),\n            children: \"Health\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Heart Count\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Height\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Melee Weapon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Chapter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"id\",\n              onChange: this.handleFilter\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"name\",\n              onChange: this.handleFilter\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            colSpan: \"7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: this.state.marines.map(marine => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.id._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.name._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [\"(\", marine.coordinates.x._text, \", \", marine.coordinates.y._text, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.health._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.heartCount._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [marine.height._text, \"m\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.meleeWeapon._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: marine.chapter.name._text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"warning\",\n              size: \"sm\",\n              children: \"Edit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"danger\",\n              size: \"sm\",\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 25\n          }, this)]\n        }, marine.id._text, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 21\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this);\n  }\n\n  renderPagination() {\n    let items = [];\n\n    for (let number = 0; number < this.state.totalPages; number++) {\n      items.push( /*#__PURE__*/_jsxDEV(Pagination.Item, {\n        active: number === this.state.currentPage,\n        onClick: () => this.handlePageChange(number),\n        children: number + 1\n      }, number, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this));\n    }\n\n    return /*#__PURE__*/_jsxDEV(Pagination, {\n      children: items\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 16\n    }, this);\n  }\n\n  renderCreateForm() {\n    return /*#__PURE__*/_jsxDEV(Form, {\n      onSubmit: this.handleCreate,\n      className: \"mb-4\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        type: \"submit\",\n        variant: \"success\",\n        children: \"Create\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }, this);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header_col\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content-container\",\n        children: [this.state.error && /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"danger\",\n          children: this.state.error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 42\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"controls\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => this.setState({\n              showCreateForm: !this.state.showCreateForm\n            }),\n            children: this.state.showCreateForm ? 'Hide Form' : 'Create New Marine'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), this.state.showCreateForm && this.renderCreateForm(), this.renderTable(), this.renderPagination()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/2398768715qq.com/GitHub/ITMO-Labs/SOA/Lab2/demo_front/my-app/src/components/main/main.jsx"],"names":["React","axios","Table","Form","Button","Pagination","Alert","XMLParser","Main","Component","constructor","props","fetchMarines","params","URLSearchParams","page","state","currentPage","pageSize","sort","sortField","order","sortOrder","filter","filters","response","get","result","xml2js","data","compact","setState","marines","SpaceMarines","SpaceMarine","totalPages","Math","ceil","totalCount","_text","error","handleError","handleSort","field","prev","handleFilter","e","target","name","value","handlePageChange","handleCreate","preventDefault","xmlBody","buildMarineXML","newMarine","post","headers","showCreateForm","marine","coordinates","x","y","health","heartCount","height","meleeWeapon","chapter","errorData","message","setTimeout","componentDidMount","renderTable","map","id","renderPagination","items","number","push","renderCreateForm","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport '../../assets/css/page_style.css';\nimport { Table, Form, Button, Pagination, Alert } from 'react-bootstrap';\nimport XMLParser from 'xml-js';\n\nexport class Main extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            marines: [],\n            currentPage: 0,\n            pageSize: 10,\n            totalPages: 0,\n            sortField: 'id',\n            sortOrder: 'ASC',\n            filters: [],\n            error: null,\n            showCreateForm: false,\n            newMarine: {\n                name: '',\n                coordinates: { x: 0, y: 0 },\n                health: 100,\n                heartCount: 1,\n                height: 1.8,\n                meleeWeapon: 'CHAIN_SWORD',\n                chapter: { name: '' }\n            }\n        };\n    }\n\n    componentDidMount() {\n        this.fetchMarines();\n    }\n\n    fetchMarines = async () => {\n        try {\n            const params = new URLSearchParams({\n                page: this.state.currentPage,\n                pageSize: this.state.pageSize,\n                sort: this.state.sortField,\n                order: this.state.sortOrder,\n                filter: this.state.filters\n            });\n\n            const response = await axios.get(`https://localhost:8083/api/v1/space-marine?${params}`);\n            const result = XMLParser.xml2js(response.data, { compact: true });\n\n            this.setState({\n                marines: result.SpaceMarines.SpaceMarine,\n                totalPages: Math.ceil(result.totalCount._text / this.state.pageSize)\n            });\n        } catch (error) {\n            this.handleError(error);\n        }\n    };\n\n    handleSort = (field) => {\n        this.setState(prev => ({\n            sortField: field,\n            sortOrder: prev.sortField === field ? (prev.sortOrder === 'ASC' ? 'DESC' : 'ASC') : 'ASC'\n        }), this.fetchMarines);\n    };\n\n    handleFilter = (e) => {\n        const filter = `${e.target.name}${e.target.value}`;\n        this.setState(prev => ({\n            filters: [...prev.filters, filter]\n        }), this.fetchMarines);\n    };\n\n    handlePageChange = (page) => {\n        this.setState({ currentPage: page }, this.fetchMarines);\n    };\n\n    handleCreate = async (e) => {\n        e.preventDefault();\n        try {\n            const xmlBody = this.buildMarineXML(this.state.newMarine);\n            await axios.post('https://localhost:8083/api/v1/space-marine', xmlBody, {\n                headers: { 'Content-Type': 'application/xml' }\n            });\n            this.fetchMarines();\n            this.setState({ showCreateForm: false });\n        } catch (error) {\n            this.handleError(error);\n        }\n    };\n\n    buildMarineXML = (marine) => {\n        return `\n      <NewSpaceMarine>\n        <name>${marine.name}</name>\n        <coordinates>\n          <x>${marine.coordinates.x}</x>\n          <y>${marine.coordinates.y}</y>\n        </coordinates>\n        <health>${marine.health}</health>\n        <heartCount>${marine.heartCount}</heartCount>\n        <height>${marine.height}</height>\n        <meleeWeapon>${marine.meleeWeapon}</meleeWeapon>\n        <chapter>\n          <name>${marine.chapter.name}</name>\n        </chapter>\n      </NewSpaceMarine>\n    `;\n    };\n\n    handleError = (error) => {\n        const errorData = XMLParser.xml2js(error.response.data, { compact: true });\n        this.setState({\n            error: errorData.error.message._text || 'Unknown error occurred'\n        });\n        setTimeout(() => this.setState({ error: null }), 5000);\n    };\n\n    renderTable() {\n        return (\n            <Table striped bordered hover responsive>\n                <thead>\n                <tr>\n                    <th onClick={() => this.handleSort('id')}>ID</th>\n                    <th onClick={() => this.handleSort('name')}>Name</th>\n                    <th>Coordinates</th>\n                    <th onClick={() => this.handleSort('health')}>Health</th>\n                    <th>Heart Count</th>\n                    <th>Height</th>\n                    <th>Melee Weapon</th>\n                    <th>Chapter</th>\n                    <th>Actions</th>\n                </tr>\n                <tr>\n                    <th><input type=\"text\" name=\"id\" onChange={this.handleFilter} /></th>\n                    <th><input type=\"text\" name=\"name\" onChange={this.handleFilter} /></th>\n                    <th colSpan=\"7\"></th>\n                </tr>\n                </thead>\n                <tbody>\n                {this.state.marines.map(marine => (\n                    <tr key={marine.id._text}>\n                        <td>{marine.id._text}</td>\n                        <td>{marine.name._text}</td>\n                        <td>({marine.coordinates.x._text}, {marine.coordinates.y._text})</td>\n                        <td>{marine.health._text}</td>\n                        <td>{marine.heartCount._text}</td>\n                        <td>{marine.height._text}m</td>\n                        <td>{marine.meleeWeapon._text}</td>\n                        <td>{marine.chapter.name._text}</td>\n                        <td>\n                            <Button variant=\"warning\" size=\"sm\">Edit</Button>\n                            <Button variant=\"danger\" size=\"sm\">Delete</Button>\n                        </td>\n                    </tr>\n                ))}\n                </tbody>\n            </Table>\n        );\n    }\n\n    renderPagination() {\n        let items = [];\n        for (let number = 0; number < this.state.totalPages; number++) {\n            items.push(\n                <Pagination.Item\n                    key={number}\n                    active={number === this.state.currentPage}\n                    onClick={() => this.handlePageChange(number)}\n                >\n                    {number + 1}\n                </Pagination.Item>\n            );\n        }\n        return <Pagination>{items}</Pagination>;\n    }\n\n    renderCreateForm() {\n        return (\n            <Form onSubmit={this.handleCreate} className=\"mb-4\">\n                {/* Form fields for all marine properties */}\n                <Button type=\"submit\" variant=\"success\">Create</Button>\n            </Form>\n        );\n    }\n\n    render() {\n        return (\n            <div>\n                <div className=\"header_col\">\n                    {/* Existing header content */}\n                </div>\n\n                <div className=\"content-container\">\n                    {this.state.error && <Alert variant=\"danger\">{this.state.error}</Alert>}\n\n                    <div className=\"controls\">\n                        <Button onClick={() => this.setState({ showCreateForm: !this.state.showCreateForm })}>\n                            {this.state.showCreateForm ? 'Hide Form' : 'Create New Marine'}\n                        </Button>\n                    </div>\n\n                    {this.state.showCreateForm && this.renderCreateForm()}\n                    {this.renderTable()}\n                    {this.renderPagination()}\n                </div>\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}