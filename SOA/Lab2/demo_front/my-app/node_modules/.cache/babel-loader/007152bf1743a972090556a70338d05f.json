{"ast":null,"code":"var _jsxFileName = \"/Users/2398768715qq.com/GitHub/ITMO-Labs/SOA/Lab2/demo_front/my-app/src/components/main/main.jsx\";\nimport React from \"react\";\nimport '../../assets/css/page_style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Main extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.fetchMarines = async () => {\n      try {\n        const params = new URLSearchParams({\n          sort: this.state.sortField,\n          order: this.state.sortOrder,\n          page: this.state.page,\n          pageSize: this.state.pageSize,\n          ...Object.fromEntries(this.state.filters.map(f => ['filter', f]))\n        });\n        const response = await fetch(`http://localhost:8083/api/v1/space-marine?${params}`);\n\n        if (!response.ok) {\n          const errorData = await this.parseXMLResponse(response);\n          throw new Error(errorData.message || 'Request failed');\n        }\n\n        const data = await this.parseXMLResponse(response);\n        this.setState({\n          marines: Array.isArray(data) ? data : [data],\n          totalPages: Math.ceil(response.headers.get('X-Total-Count') / this.state.pageSize),\n          error: null\n        });\n      } catch (error) {\n        this.setState({\n          error: error.message\n        });\n      }\n    };\n\n    this.parseXMLResponse = async response => {\n      const text = await response.text();\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(text, \"application/xml\");\n      return this.xmlToJson(xmlDoc);\n    };\n\n    this.xmlToJson = xml => {\n      // 简化的XML转换逻辑，实际需要根据API响应结构完善\n      const items = xml.getElementsByTagName('SpaceMarine');\n      return Array.from(items).map(item => {\n        var _item$querySelector, _item$querySelector2, _item$querySelector3, _item$querySelector4, _item$querySelector5, _item$querySelector6, _item$querySelector7;\n\n        return {\n          id: (_item$querySelector = item.querySelector('id')) === null || _item$querySelector === void 0 ? void 0 : _item$querySelector.textContent,\n          name: (_item$querySelector2 = item.querySelector('name')) === null || _item$querySelector2 === void 0 ? void 0 : _item$querySelector2.textContent,\n          health: (_item$querySelector3 = item.querySelector('health')) === null || _item$querySelector3 === void 0 ? void 0 : _item$querySelector3.textContent,\n          heartCount: (_item$querySelector4 = item.querySelector('heartCount')) === null || _item$querySelector4 === void 0 ? void 0 : _item$querySelector4.textContent,\n          height: (_item$querySelector5 = item.querySelector('height')) === null || _item$querySelector5 === void 0 ? void 0 : _item$querySelector5.textContent,\n          coordinates: {\n            x: (_item$querySelector6 = item.querySelector('coordinates x')) === null || _item$querySelector6 === void 0 ? void 0 : _item$querySelector6.textContent,\n            y: (_item$querySelector7 = item.querySelector('coordinates y')) === null || _item$querySelector7 === void 0 ? void 0 : _item$querySelector7.textContent\n          }\n        };\n      });\n    };\n\n    this.handleFilterChange = e => {\n      this.setState({\n        currentFilter: e.target.value\n      });\n    };\n\n    this.addFilter = () => {\n      if (this.state.currentFilter) {\n        this.setState(prev => ({\n          filters: [...prev.filters, prev.currentFilter],\n          currentFilter: ''\n        }), this.fetchMarines);\n      }\n    };\n\n    this.handlePageChange = newPage => {\n      this.setState({\n        page: newPage\n      }, this.fetchMarines);\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n\n      try {\n        const response = await fetch('http://localhost:8083/api/v1/space-marine', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/xml'\n          },\n          body: `\n          <NewSpaceMarine>\n            <name>${this.state.newMarine.name}</name>\n            <health>${this.state.newMarine.health}</health>\n            <heartCount>${this.state.newMarine.heartCount}</heartCount>\n            <height>${this.state.newMarine.height}</height>\n          </NewSpaceMarine>\n        `\n        });\n        if (!response.ok) throw new Error('创建失败');\n        this.setState({\n          newMarine: {\n            name: '',\n            health: '',\n            heartCount: '',\n            height: ''\n          },\n          error: null\n        }, this.fetchMarines);\n      } catch (error) {\n        this.setState({\n          error: error.message\n        });\n      }\n    };\n\n    this.state = {\n      marines: [],\n      error: null,\n      sortField: 'id',\n      sortOrder: 'ASC',\n      filters: [],\n      currentFilter: '',\n      page: 0,\n      pageSize: 10,\n      totalPages: 0,\n      newMarine: {\n        name: '',\n        health: '',\n        heartCount: '',\n        height: ''\n      },\n      searchId: ''\n    };\n  }\n\n  componentDidMount() {\n    this.fetchMarines();\n  }\n\n  render() {\n    const {\n      marines,\n      error,\n      page,\n      totalPages\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header_col\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"select\", {\n          onChange: e => this.setState({\n            sortField: e.target.value\n          }, this.fetchMarines),\n          children: ['id', 'name', 'health', 'heartCount'].map(field => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: field,\n            children: field\n          }, field, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          onChange: e => this.setState({\n            sortOrder: e.target.value\n          }, this.fetchMarines),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"ASC\",\n            children: \"\\u5347\\u5E8F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"DESC\",\n            children: \"\\u964D\\u5E8F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"\\u6DFB\\u52A0\\u8FC7\\u6EE4\\u6761\\u4EF6\\uFF08\\u5982\\uFF1Ahealth>100\\uFF09\",\n          value: this.state.currentFilter,\n          onChange: this.handleFilterChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.addFilter,\n          children: \"\\u6DFB\\u52A0\\u8FC7\\u6EE4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"data-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"ID\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u540D\\u79F0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u751F\\u547D\\u503C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u5FC3\\u810F\\u6570\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u8EAB\\u9AD8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u5750\\u6807\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: marines.map(marine => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.health\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.heartCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.height\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: marine.coordinates && `${marine.coordinates.x}, ${marine.coordinates.y}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 29\n            }, this)]\n          }, marine.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pagination\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: page === 0,\n          onClick: () => this.handlePageChange(page - 1),\n          children: \"\\u4E0A\\u4E00\\u9875\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u7B2C \", page + 1, \" \\u9875 / \\u5171 \", totalPages, \" \\u9875\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: page >= totalPages - 1,\n          onClick: () => this.handlePageChange(page + 1),\n          children: \"\\u4E0B\\u4E00\\u9875\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"creation-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u65B0\\u5EFA\\u592A\\u7A7A\\u9646\\u6218\\u961F\\u5458\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: this.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u59D3\\u540D\",\n            value: this.state.newMarine.name,\n            onChange: e => this.setState({\n              newMarine: { ...this.state.newMarine,\n                name: e.target.value\n              }\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            placeholder: \"\\u751F\\u547D\\u503C\",\n            value: this.state.newMarine.health,\n            onChange: e => this.setState({\n              newMarine: { ...this.state.newMarine,\n                health: e.target.value\n              }\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            placeholder: \"\\u5FC3\\u810F\\u6570\",\n            min: \"1\",\n            max: \"3\",\n            value: this.state.newMarine.heartCount,\n            onChange: e => this.setState({\n              newMarine: { ...this.state.newMarine,\n                heartCount: e.target.value\n              }\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            step: \"0.1\",\n            placeholder: \"\\u8EAB\\u9AD8\",\n            value: this.state.newMarine.height,\n            onChange: e => this.setState({\n              newMarine: { ...this.state.newMarine,\n                height: e.target.value\n              }\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"\\u521B\\u5EFA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/2398768715qq.com/GitHub/ITMO-Labs/SOA/Lab2/demo_front/my-app/src/components/main/main.jsx"],"names":["React","Main","Component","constructor","props","fetchMarines","params","URLSearchParams","sort","state","sortField","order","sortOrder","page","pageSize","Object","fromEntries","filters","map","f","response","fetch","ok","errorData","parseXMLResponse","Error","message","data","setState","marines","Array","isArray","totalPages","Math","ceil","headers","get","error","text","parser","DOMParser","xmlDoc","parseFromString","xmlToJson","xml","items","getElementsByTagName","from","item","id","querySelector","textContent","name","health","heartCount","height","coordinates","x","y","handleFilterChange","e","currentFilter","target","value","addFilter","prev","handlePageChange","newPage","handleSubmit","preventDefault","method","body","newMarine","searchId","componentDidMount","render","field","marine"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport '../../assets/css/page_style.css'\n\nexport class Main extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            marines: [],\n            error: null,\n            sortField: 'id',\n            sortOrder: 'ASC',\n            filters: [],\n            currentFilter: '',\n            page: 0,\n            pageSize: 10,\n            totalPages: 0,\n            newMarine: {\n                name: '',\n                health: '',\n                heartCount: '',\n                height: ''\n            },\n            searchId: ''\n        };\n    }\n\n    componentDidMount() {\n        this.fetchMarines();\n    }\n\n    fetchMarines = async () => {\n        try {\n            const params = new URLSearchParams({\n                sort: this.state.sortField,\n                order: this.state.sortOrder,\n                page: this.state.page,\n                pageSize: this.state.pageSize,\n                ...Object.fromEntries(this.state.filters.map(f => ['filter', f]))\n            });\n\n            const response = await fetch(`http://localhost:8083/api/v1/space-marine?${params}`);\n\n            if (!response.ok) {\n                const errorData = await this.parseXMLResponse(response);\n                throw new Error(errorData.message || 'Request failed');\n            }\n\n            const data = await this.parseXMLResponse(response);\n            this.setState({\n                marines: Array.isArray(data) ? data : [data],\n                totalPages: Math.ceil(response.headers.get('X-Total-Count') / this.state.pageSize),\n                error: null\n            });\n        } catch (error) {\n            this.setState({ error: error.message });\n        }\n    };\n\n    parseXMLResponse = async (response) => {\n        const text = await response.text();\n        const parser = new DOMParser();\n        const xmlDoc = parser.parseFromString(text, \"application/xml\");\n        return this.xmlToJson(xmlDoc);\n    };\n\n    xmlToJson = (xml) => {\n        // 简化的XML转换逻辑，实际需要根据API响应结构完善\n        const items = xml.getElementsByTagName('SpaceMarine');\n        return Array.from(items).map(item => ({\n            id: item.querySelector('id')?.textContent,\n            name: item.querySelector('name')?.textContent,\n            health: item.querySelector('health')?.textContent,\n            heartCount: item.querySelector('heartCount')?.textContent,\n            height: item.querySelector('height')?.textContent,\n            coordinates: {\n                x: item.querySelector('coordinates x')?.textContent,\n                y: item.querySelector('coordinates y')?.textContent\n            }\n        }));\n    };\n\n    handleFilterChange = (e) => {\n        this.setState({ currentFilter: e.target.value });\n    };\n\n    addFilter = () => {\n        if (this.state.currentFilter) {\n            this.setState(prev => ({\n                filters: [...prev.filters, prev.currentFilter],\n                currentFilter: ''\n            }), this.fetchMarines);\n        }\n    };\n\n    handlePageChange = (newPage) => {\n        this.setState({ page: newPage }, this.fetchMarines);\n    };\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            const response = await fetch('http://localhost:8083/api/v1/space-marine', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/xml' },\n                body: `\n          <NewSpaceMarine>\n            <name>${this.state.newMarine.name}</name>\n            <health>${this.state.newMarine.health}</health>\n            <heartCount>${this.state.newMarine.heartCount}</heartCount>\n            <height>${this.state.newMarine.height}</height>\n          </NewSpaceMarine>\n        `\n            });\n\n            if (!response.ok) throw new Error('创建失败');\n\n            this.setState({\n                newMarine: { name: '', health: '', heartCount: '', height: '' },\n                error: null\n            }, this.fetchMarines);\n        } catch (error) {\n            this.setState({ error: error.message });\n        }\n    };\n\n    render() {\n        const { marines, error, page, totalPages } = this.state;\n\n        return (\n            <div>\n                <div className=\"header_col\">\n                    {/* 原有头部内容保持不变 */}\n                </div>\n\n                <div className=\"controls\">\n                    <select onChange={e => this.setState({ sortField: e.target.value }, this.fetchMarines)}>\n                        {['id', 'name', 'health', 'heartCount'].map(field => (\n                            <option key={field} value={field}>{field}</option>\n                        ))}\n                    </select>\n\n                    <select onChange={e => this.setState({ sortOrder: e.target.value }, this.fetchMarines)}>\n                        <option value=\"ASC\">升序</option>\n                        <option value=\"DESC\">降序</option>\n                    </select>\n\n                    <input\n                        type=\"text\"\n                        placeholder=\"添加过滤条件（如：health>100）\"\n                        value={this.state.currentFilter}\n                        onChange={this.handleFilterChange}\n                    />\n                    <button onClick={this.addFilter}>添加过滤</button>\n                </div>\n\n                {error && <div className=\"error\">{error}</div>}\n\n                <table className=\"data-table\">\n                    <thead>\n                    <tr>\n                        <th>ID</th>\n                        <th>名称</th>\n                        <th>生命值</th>\n                        <th>心脏数</th>\n                        <th>身高</th>\n                        <th>坐标</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    {marines.map(marine => (\n                        <tr key={marine.id}>\n                            <td>{marine.id}</td>\n                            <td>{marine.name}</td>\n                            <td>{marine.health}</td>\n                            <td>{marine.heartCount}</td>\n                            <td>{marine.height}</td>\n                            <td>{marine.coordinates && `${marine.coordinates.x}, ${marine.coordinates.y}`}</td>\n                        </tr>\n                    ))}\n                    </tbody>\n                </table>\n\n                <div className=\"pagination\">\n                    <button\n                        disabled={page === 0}\n                        onClick={() => this.handlePageChange(page - 1)}\n                    >\n                        上一页\n                    </button>\n                    <span>第 {page + 1} 页 / 共 {totalPages} 页</span>\n                    <button\n                        disabled={page >= totalPages - 1}\n                        onClick={() => this.handlePageChange(page + 1)}\n                    >\n                        下一页\n                    </button>\n                </div>\n\n                <div className=\"creation-form\">\n                    <h3>新建太空陆战队员</h3>\n                    <form onSubmit={this.handleSubmit}>\n                        <input\n                            type=\"text\"\n                            placeholder=\"姓名\"\n                            value={this.state.newMarine.name}\n                            onChange={e => this.setState({ newMarine: {...this.state.newMarine, name: e.target.value }})}\n                            required\n                        />\n                        <input\n                            type=\"number\"\n                            placeholder=\"生命值\"\n                            value={this.state.newMarine.health}\n                            onChange={e => this.setState({ newMarine: {...this.state.newMarine, health: e.target.value }})}\n                        />\n                        <input\n                            type=\"number\"\n                            placeholder=\"心脏数\"\n                            min=\"1\"\n                            max=\"3\"\n                            value={this.state.newMarine.heartCount}\n                            onChange={e => this.setState({ newMarine: {...this.state.newMarine, heartCount: e.target.value }})}\n                        />\n                        <input\n                            type=\"number\"\n                            step=\"0.1\"\n                            placeholder=\"身高\"\n                            value={this.state.newMarine.height}\n                            onChange={e => this.setState({ newMarine: {...this.state.newMarine, height: e.target.value }})}\n                        />\n                        <button type=\"submit\">创建</button>\n                    </form>\n                </div>\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}